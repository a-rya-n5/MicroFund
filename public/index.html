<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MicroFund ‚Äî Smart Micro-Lending</title>
  <link rel="stylesheet" href="/css/style.css">
  <style>
    .features-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 24px; }
    .feature-item { display: flex; align-items: flex-start; gap: 10px; padding: 12px; background: rgba(212,168,83,0.05); border: 1px solid rgba(212,168,83,0.15); border-radius: 10px; }
    .feature-icon { font-size: 20px; flex-shrink: 0; }
    .feature-text { font-size: 12px; color: var(--text-muted); }
    .feature-text strong { display: block; font-size: 13px; color: var(--text-secondary); margin-bottom: 2px; }
    @media (max-width: 600px) { .features-grid { grid-template-columns: 1fr; } }
    .demo-badge { display: inline-block; background: rgba(212,168,83,0.15); border: 1px solid rgba(212,168,83,0.3); border-radius: 6px; padding: 4px 10px; font-size: 11px; color: var(--gold); margin-bottom: 8px; }
    .demo-accounts { background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 10px; padding: 14px 16px; margin-top: 16px; }
    .demo-row { display: flex; justify-content: space-between; align-items: center; padding: 4px 0; font-size: 12px; }
    .demo-row span:first-child { color: var(--text-muted); }
    .demo-row span:last-child { font-family: 'DM Mono', monospace; color: var(--gold); cursor: pointer; }
    .demo-row span:last-child:hover { text-decoration: underline; }
    .split-layout { display: grid; grid-template-columns: 1fr 1fr; min-height: 100vh; }
    .hero-panel { background: linear-gradient(160deg, #0B1628 0%, #111F38 50%, #0B1628 100%); padding: 48px; display: flex; flex-direction: column; justify-content: center; position: relative; overflow: hidden; }
    .hero-panel::before { content: ''; position: absolute; top: -100px; right: -100px; width: 400px; height: 400px; border-radius: 50%; background: radial-gradient(circle, rgba(212,168,83,0.08) 0%, transparent 70%); }
    .hero-panel::after { content: ''; position: absolute; bottom: -80px; left: -80px; width: 300px; height: 300px; border-radius: 50%; background: radial-gradient(circle, rgba(59,130,246,0.06) 0%, transparent 70%); }
    .auth-panel { background: var(--navy-2); display: flex; align-items: center; justify-content: center; padding: 48px; }
    .hero-title { font-family: 'Fraunces', serif; font-size: 44px; font-weight: 900; color: var(--text-primary); line-height: 1.1; margin-bottom: 16px; }
    .hero-title span { color: var(--gold); }
    .hero-desc { font-size: 16px; color: var(--text-secondary); line-height: 1.7; margin-bottom: 32px; }
    .stat-pills { display: flex; gap: 12px; flex-wrap: wrap; }
    .stat-pill { background: rgba(212,168,83,0.1); border: 1px solid rgba(212,168,83,0.2); border-radius: 100px; padding: 6px 14px; font-size: 13px; }
    .stat-pill-val { font-weight: 700; color: var(--gold); }
    .stat-pill-lbl { color: var(--text-muted); }
    @media (max-width: 900px) { .split-layout { grid-template-columns: 1fr; } .hero-panel { display: none; } }
  </style>
</head>
<body>
<div class="page-bg"></div>

<div class="split-layout">
  <!-- Hero Panel -->
  <div class="hero-panel">
    <div style="position:relative;z-index:1">
      <div style="font-family:'Fraunces',serif;font-size:28px;font-weight:900;color:var(--gold);margin-bottom:48px">‚ö° MicroFund</div>
      <h1 class="hero-title">Smart Lending,<br><span>Real Returns</span></h1>
      <p class="hero-desc">Connect directly with borrowers. Fund micro-loans, track repayments, and earn competitive returns ‚Äî all in one transparent platform.</p>
      <div class="stat-pills">
        <div class="stat-pill"><span class="stat-pill-val">‚Çπ50Cr+</span> <span class="stat-pill-lbl">Disbursed</span></div>
        <div class="stat-pill"><span class="stat-pill-val">12,000+</span> <span class="stat-pill-lbl">Borrowers</span></div>
        <div class="stat-pill"><span class="stat-pill-val">98.2%</span> <span class="stat-pill-lbl">Repayment Rate</span></div>
      </div>
      <div class="features-grid">
        <div class="feature-item">
          <div class="feature-icon">üîê</div>
          <div class="feature-text"><strong>Secure Auth</strong>JWT-backed sessions with role-based access</div>
        </div>
        <div class="feature-item">
          <div class="feature-icon">üí≥</div>
          <div class="feature-text"><strong>Live Wallets</strong>Real-time balance on every transaction</div>
        </div>
        <div class="feature-item">
          <div class="feature-icon">üìÖ</div>
          <div class="feature-text"><strong>EMI Schedules</strong>Compound interest with full amortization</div>
        </div>
        <div class="feature-item">
          <div class="feature-icon">‚≠ê</div>
          <div class="feature-text"><strong>Credit Engine</strong>Dynamic scores updated after each payment</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Auth Panel -->
  <div class="auth-panel">
    <div class="auth-card">
      <div class="auth-header">
        <div class="auth-logo">‚ö° MicroFund</div>
        <div class="auth-tagline">Smart Micro-Lending Platform</div>
      </div>

      <div class="tab-group">
        <button class="tab-btn active" id="loginTab" onclick="switchTab('login')">Sign In</button>
        <button class="tab-btn" id="registerTab" onclick="switchTab('register')">Create Account</button>
      </div>

      <!-- Login Form -->
      <div id="loginForm">
        <div class="demo-accounts">
          <div class="demo-badge">üéØ Demo Accounts</div>
          <div class="demo-row"><span>Admin</span><span onclick="fillDemo('admin@mf.com','admin123')">admin@mf.com / admin123</span></div>
          <div class="demo-row"><span>Borrower</span><span onclick="fillDemo('borrower@mf.com','demo123')">borrower@mf.com / demo123</span></div>
          <div class="demo-row"><span>Lender</span><span onclick="fillDemo('lender@mf.com','demo123')">lender@mf.com / demo123</span></div>
        </div>

        <div style="margin-top:20px">
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <input type="email" id="loginEmail" class="form-input" placeholder="you@example.com" autocomplete="email">
          </div>
          <div class="form-group">
            <label class="form-label">Password</label>
            <input type="password" id="loginPassword" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
          </div>
          <div id="loginError" style="color:var(--danger);font-size:13px;margin-bottom:12px;display:none"></div>
          <button class="btn btn-primary w-full btn-lg" onclick="handleLogin()" id="loginBtn">Sign In ‚Üí</button>
        </div>
      </div>

      <!-- Register Form -->
      <div id="registerForm" style="display:none">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Full Name</label>
            <input type="text" id="regName" class="form-input" placeholder="Priya Sharma">
          </div>
          <div class="form-group">
            <label class="form-label">Phone Number</label>
            <input type="tel" id="regPhone" class="form-input" placeholder="+91 98765 43210">
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Email Address</label>
          <input type="email" id="regEmail" class="form-input" placeholder="you@example.com">
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" id="regPassword" class="form-input" placeholder="Min 6 characters">
        </div>
        <div class="form-group">
          <label class="form-label">Account Type</label>
          <select id="regRole" class="form-input form-select">
            <option value="borrower">üè¶ Borrower ‚Äî Apply for micro-loans</option>
            <option value="lender">üí∞ Lender ‚Äî Fund loans & earn returns</option>
          </select>
        </div>
        <div id="regError" style="color:var(--danger);font-size:13px;margin-bottom:12px;display:none"></div>
        <button class="btn btn-primary w-full btn-lg" onclick="handleRegister()" id="registerBtn">Create Account ‚Üí</button>
        <p style="font-size:12px;color:var(--text-muted);text-align:center;margin-top:12px">By signing up, you agree to our Terms of Service and Privacy Policy</p>
      </div>
    </div>
  </div>
</div>

<div class="toast-container" id="toastContainer"></div>

<script src="/js/common.js"></script>
<script>
  // Theme init
  Theme.init();

  // Redirect if already logged in
  if (Auth.isLoggedIn()) {
    window.location.href = '/dashboard.html';
  }

  // Tab switching
  function switchTab(tab) {
    const isLogin = tab === 'login';
    document.getElementById('loginTab').classList.toggle('active', isLogin);
    document.getElementById('registerTab').classList.toggle('active', !isLogin);
    document.getElementById('loginForm').style.display = isLogin ? 'block' : 'none';
    document.getElementById('registerForm').style.display = isLogin ? 'none' : 'block';
  }

  // Fill demo credentials
  function fillDemo(email, pass) {
    document.getElementById('loginEmail').value = email;
    document.getElementById('loginPassword').value = pass;
    Toast.info('Demo credentials filled', 'Click Sign In to continue');
  }

  // Login handler
  async function handleLogin() {
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value;
    const errorEl = document.getElementById('loginError');
    const btn = document.getElementById('loginBtn');

    errorEl.style.display = 'none';

    if (!email || !password) {
      errorEl.textContent = 'Please enter email and password';
      errorEl.style.display = 'block';
      return;
    }

    btn.textContent = 'Signing in...';
    btn.disabled = true;

    const res = await api.post('/auth/login', { email, password });

    if (res.ok) {
      Auth.setSession(res.data.token, res.data.user);
      Toast.success('Welcome back!', `Logged in as ${res.data.user.name}`);
      setTimeout(() => { window.location.href = '/dashboard.html'; }, 500);
    } else {
      errorEl.textContent = res.data.message || 'Login failed';
      errorEl.style.display = 'block';
      btn.textContent = 'Sign In ‚Üí';
      btn.disabled = false;
    }
  }

  // Register handler
  async function handleRegister() {
    const name = document.getElementById('regName').value.trim();
    const email = document.getElementById('regEmail').value.trim();
    const password = document.getElementById('regPassword').value;
    const role = document.getElementById('regRole').value;
    const phone = document.getElementById('regPhone').value.trim();
    const errorEl = document.getElementById('regError');
    const btn = document.getElementById('registerBtn');

    errorEl.style.display = 'none';

    if (!name || !email || !password) {
      errorEl.textContent = 'Please fill all required fields';
      errorEl.style.display = 'block';
      return;
    }

    if (password.length < 6) {
      errorEl.textContent = 'Password must be at least 6 characters';
      errorEl.style.display = 'block';
      return;
    }

    btn.textContent = 'Creating account...';
    btn.disabled = true;

    const res = await api.post('/auth/register', { name, email, password, role, phone });

    if (res.ok) {
      Auth.setSession(res.data.token, res.data.user);
      Toast.success('Account created!', `Welcome to MicroFund, ${res.data.user.name}!`);
      setTimeout(() => { window.location.href = '/dashboard.html'; }, 500);
    } else {
      errorEl.textContent = res.data.message || 'Registration failed';
      errorEl.style.display = 'block';
      btn.textContent = 'Create Account ‚Üí';
      btn.disabled = false;
    }
  }

  // Enter key handler
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') {
      if (document.getElementById('loginForm').style.display !== 'none') handleLogin();
      else handleRegister();
    }
  });
</script>
</body>
</html>
